import{_ as i}from"./chunks/plugin-vue_export-helper.DlAUqK2U.js";import{c as a,o as n,X as h}from"./chunks/vendor-vueuse.XPft87tp.js";const l="/blog/assets/2023-01-06-14-09-28.5689rl8k.png",k="/blog/assets/2023-01-06-14-09-39.k47YkA8U.png",p="/blog/assets/2023-01-06-14-09-53.CSA9reSj.png",t="/blog/assets/2023-01-06-14-10-02.DVW412b-.png",e="/blog/assets/2023-01-06-12-39-32.QfB83YgR.png",F="/blog/assets/2023-01-06-12-40-13.CZEO4o4g.png",r="/blog/assets/2023-01-06-12-41-12.BqHE1yim.png",D=JSON.parse('{"title":"异步处理","description":"","frontmatter":{},"headers":[],"relativePath":"js/异步处理.md","filePath":"js/异步处理.md","lastUpdated":1771466668000}'),d={name:"js/异步处理.md"};function g(y,s,c,o,A,b){return n(),a("div",null,s[0]||(s[0]=[h(`<h1 id="异步处理" tabindex="-1">异步处理 <a class="header-anchor" href="#异步处理" aria-label="Permalink to &quot;异步处理&quot;">​</a></h1><h2 id="事件循环-eventloop" tabindex="-1">事件循环 eventLoop <a class="header-anchor" href="#事件循环-eventloop" aria-label="Permalink to &quot;事件循环 eventLoop&quot;">​</a></h2><p>JS 运行的环境称之为宿主环境。JS语言不只运行在浏览器</p><p>执行栈：call stack(一个数据结构)，用于存放各种函数的执行环境，每一个函数执行之前，它的相关信息会加入到执行栈。函数调用之前，创建执行环境，然后加入到执行栈；函数调用之后，销毁执行环境。 JS 引擎永远执行的是执行栈的最顶部。</p><p>异步函数：某些函数不会立即执行，需要等到某个时机到达后才会执行，这样的函数称之为异步函数。比如事件处理函数。异步函数的执行时机，会被宿主环境控制。 浏览器宿主环境中包含 5 个线程：</p><ul><li>JS 引擎：负责执行执行栈的最顶部代码</li><li>GUI 线程：负责渲染页面</li><li>事件监听线程：负责监听各种事件</li><li>计时线程：负责计时</li><li>网络线程：负责网络通信</li></ul><p>当上面的线程发生了某些事请，如果该线程发现，这件事情有处理程序，它会将该处理程序加入一个叫做事件队列的内存。当 JS 引擎发现，执行栈中已经没有了任何内容后，会将事件队列中的第一个函数加入到执行栈中执行。 JS 引擎对事件队列的取出执行方式，以及与宿主环境的配合，称之为事件循环。</p><p><a href="https://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="noreferrer">JavaScript 运行机制详解：再谈Event Loop</a></p><p>事件队列在不同的宿主环境中有所差异，大部分宿主环境会将事件队列进行细分。在浏览器中，事件队列分为两种：</p><ul><li>宏任务（队列）：macroTask，计时器结束的回调、事件回调、http 回调等等绝大部分异步函数进入宏队列</li><li>微任务（队列）：MutationObserver，Promise 产生的回调进入微队列——vip</li></ul><blockquote><p>MutationObserver 用于监听某个 DOM 对象的变化 当执行栈清空时，JS 引擎首先会将微任务中的所有任务依次执行结束，如果没有微任务，则执行宏任务。</p></blockquote><p>看下面一串代码</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> ul</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">container</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">onclick</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> A</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> li</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">createElement</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">li</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    li</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">innerText</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    ul</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">appendChild</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">li</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">添加了一个li</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  //监听ul</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> observer</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> MutationObserver</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> B</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //当监听的dom元素发生变化时运行的回调函数</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">ul元素发生了变化</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  //监听ul</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  observer</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">observe</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">ul</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">  </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">    attributes</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //监听属性的变化</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">    childList</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //监听子元素的变化</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">    subtree</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //监听子树的变化</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>为什么先执行宏队列了？</p><blockquote><p>点击按钮的时候还没有往ul里面加li，所以微队列也不执行</p></blockquote><p>宏队列演示</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">ul</span><span style="--shiki-light:#50FA7B;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> id</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">container</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">ul</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#50FA7B;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> id</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">点击</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> ul</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">container</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">onclick</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> A</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> C</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">          console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">添加了一个li</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">      var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> li</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">createElement</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">li</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      li</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">innerText</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      ul</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">appendChild</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">li</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  //监听ul</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> observer</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> MutationObserver</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> B</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">      //当监听的dom元素发生变化时运行的回调函数</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">ul元素发生了变化</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  //监听ul</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  observer</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">observe</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">ul</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">	</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">      attributes</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //监听属性的变化</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">      childList</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //监听子元素的变化</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">      subtree</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //监听子树的变化</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  //取消监听</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  // observer.disconnect();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h2 id="事件和回调函数缺陷" tabindex="-1">事件和回调函数缺陷 <a class="header-anchor" href="#事件和回调函数缺陷" aria-label="Permalink to &quot;事件和回调函数缺陷&quot;">​</a></h2><p>我们习惯于使用传统的回调或事件处理来解决异步问题 事件：某个对象的属性是一个函数，当发生某一件事时，运行该函数</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">dom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">onclick</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> ()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>回调：运行某个函数以实现某个功能的时候，传入一个函数作为参数，当发生某件事的时候，会运行该函数。</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">dom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">addEventListener</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">click</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> ()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>本质上，事件和回调并没有本质的区别，只是把函数放置的位置不同而已。一直以来，该模式都运作良好。直到前端工程越来越复杂... 目前，该模式主要面临以下两个问题：</p><ol><li>回调地狱：某个异步操作需要等待之前的异步操作完成，无论用回调还是事件，都会陷入不断的嵌套</li><li>异步之间的联系：某个异步操作要等待多个异步操作的结果，对这种联系的处理，会让代码的复杂度剧增</li></ol><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">p</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    &lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#50FA7B;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> id</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">按钮1：给按钮2注册点击事件</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    &lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#50FA7B;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> id</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">按钮2：给按钮3注册点击事件</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    &lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#50FA7B;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> id</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn3</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">按钮3：点击后弹出hello</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">button</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">p</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> btn1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">          btn2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">          btn3</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">btn3</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    btn1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">addEventListener</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">click</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">        //按钮1的其他事情</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        btn2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">addEventListener</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">click</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">            //按钮2的其他事情</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">            btn3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">addEventListener</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">click</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">                alert</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">hello</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">            })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="异步处理的通用模型" tabindex="-1">异步处理的通用模型 <a class="header-anchor" href="#异步处理的通用模型" aria-label="Permalink to &quot;异步处理的通用模型&quot;">​</a></h2><p>ES 官方参考了大量的异步场景，总结出了一套异步的通用模型，该模型可以覆盖几乎所有的异步场景，甚至是同步场景。 值得注意的是，为了兼容旧系统，ES6 并不打算抛弃掉过去的做法，只是基于该模型推出一个全新的 API，使用该 API，会让异步处理更加的简洁优雅。 理解该 API，最重要的，是理解它的异步模型</p><ol><li>ES6 将某一件可能发生异步操作的事情，分为两个阶段：<strong>unsettled</strong> 和 <strong>settled</strong></li></ol><ul><li>unsettled： 未决阶段，表示事情还在进行前期的处理，并没有发生通向结果的那件事</li><li>settled：已决阶段，事情已经有了一个结果，不管这个结果是好是坏，整件事情无法逆转</li></ul><p>事情总是从 未决阶段 逐步发展到 已决阶段的。并且，未决阶段拥有控制何时通向已决阶段的能力。</p><ol start="2"><li>ES6 将事情划分为三种状态： pending、resolved、rejected</li></ol><ul><li>pending: 挂起，处于未决阶段，则表示这件事情还在挂起（最终的结果还没出来）</li><li>resolved：已处理，已决阶段的一种状态，表示整件事情已经出现结果，并是一个可以按照正常逻辑进行下去的结果</li><li>rejected：已拒绝，已决阶段的一种状态，表示整件事情已经出现结果，并是一个无法按照正常逻辑进行下去的结果，通常用于表示有一个错误</li></ul><p>既然未决阶段有权力决定事情的走向，因此，未决阶段可以决定事情最终的状态！</p><p>我们将 把事情变为 resolved 状态的过程叫做：<strong>resolve</strong>，推向该状态时，可能会传递一些数据</p><p>我们将 把事情变为 rejected 状态的过程叫做：<strong>reject</strong>，推向该状态时，同样可能会传递一些数据，通常为错误信息</p><p><strong>始终记住，无论是阶段，还是状态，是不可逆的！</strong></p><ol start="3"><li>当事情达到已决阶段后，通常需要进行后续处理，不同的已决状态，决定了不同的后续处理。</li></ol><ul><li>resolved 状态：这是一个正常的已决状态，后续处理表示为 thenable</li><li>rejected 状态：这是一个非正常的已决状态，后续处理表示为 catchable</li></ul><p>后续处理可能有多个，因此会形成作业队列，这些后续处理会按照顺序，当状态到达后依次执行</p><ol start="4"><li>整件事称之为 Promise</li></ol><p><strong>理解上面的概念，对学习 Promise 至关重要！</strong></p><h3 id="promise-a" tabindex="-1">Promise A+ <a class="header-anchor" href="#promise-a" aria-label="Permalink to &quot;Promise A+&quot;">​</a></h3><p>Promise是一套专门处理异步场景的规范，它能有效的避免回调地狱的产生，使异步代码更加清晰、简洁、统一</p><p>这套规范最早诞生于前端社区，规范名称为<a href="https://promisesaplus.com/" target="_blank" rel="noreferrer">Promise A+</a></p><p>该规范出现后，立即得到了很多开发者的响应</p><p>Promise A+ 规定：</p><ol><li>所有的异步场景，都可以看作是一个异步任务，每个异步任务，在JS中应该表现为一个<strong>对象</strong>，该对象称之为<strong>Promise对象</strong>，也叫做任务对象 <img src="`+l+'" alt=""></li><li>每个任务对象，都应该有两个阶段、三个状态 <img src="'+k+'" alt=""></li></ol><p>根据常理，它们之间存在以下逻辑：</p><ul><li>任务总是从未决阶段变到已决阶段，无法逆行</li><li>任务总是从挂起状态变到完成或失败状态，无法逆行</li><li>时间不能倒流，历史不可改写，任务一旦完成或失败，状态就固定下来，永远无法改变</li></ul><ol start="3"><li><code>挂起-&gt;完成</code>，称之为<code>resolve</code>；<code>挂起-&gt;失败</code>称之为<code>reject</code>。任务完成时，可能有一个相关数据；任务失败时，可能有一个失败原因。</li></ol><p><img src="'+p+'" alt=""></p><ol start="4"><li>可以针对任务进行后续处理，针对完成状态的后续处理称之为onFulfilled，针对失败的后续处理称之为onRejected</li></ol><p><img src="'+t+`" alt=""></p><p>ES6提供了一套API，实现了Promise A+规范</p><h2 id="promise的基本使用" tabindex="-1">Promise的基本使用 <a class="header-anchor" href="#promise的基本使用" aria-label="Permalink to &quot;Promise的基本使用&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // 未决阶段的处理</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // 通过调用resolve函数将Promise推向已决阶段的resolved状态</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // 通过调用reject函数将Promise推向已决阶段的rejected状态</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // resolve和reject均可以传递最多一个参数，表示推向状态的数据</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  // 立即执行</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //这是thenable函数，如果当前的Promise已经是resolved状态，该函数会立即执行</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //如果当前是未决阶段，则会加入到作业队列，等待到达resolved状态后执行</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //data为状态数据</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //这是catchable函数，如果当前的Promise已经是rejected状态，该函数会立即执行</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //如果当前是未决阶段，则会加入到作业队列，等待到达rejected状态后执行</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //err为状态数据</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>细节</strong></p><ul><li>未决阶段的处理函数是同步的，会立即执行</li><li>thenable和catchable函数是异步的，就算是立即执行，也会加入到事件队列中等待执行，并且，加入的队列是微队列</li><li>pro.then可以只添加thenable函数，pro.catch可以单独添加catchable函数</li><li>在未决阶段的处理函数中，如果发生未捕获的错误，会将状态推向rejected，并会被catchable捕获</li><li>一旦状态推向了已决阶段，无法再对状态做任何更改</li><li><strong>Promise并没有消除回调，只是让回调变得可控</strong></li></ul><p>创建 Promise</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>封装Ajax</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 辅助函数,把传进来的对象拼接成url的字符串</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> toData</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">obj</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#BD93F9;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> arr</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> [];</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> in</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> str</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">=</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">];</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    arr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">push</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">str</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> arr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">join</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">&amp;</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 封装Ajax</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> ajax</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //指定提交方式的默认值</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">type</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">type</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">get</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //设置是否异步，默认为true(异步)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //设置数据的默认值</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#BD93F9;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // 根据不同的浏览器创建XHR对象</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> xhr</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#CB7676;"> null</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">window</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">XMLHttpRequest</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">      // 非IE浏览器</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      xhr</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> XMLHttpRequest</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">      // IE浏览器</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      xhr</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> ActiveXObject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">Microsoft.XMLHTTP</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // 区分get和post,发送HTTP请求</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">type</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">post</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">open</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">type</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">url</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">async</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setRequestHeader</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">Content-Type</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">application/x-www-form-urlencoded</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">      let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> toData</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">send</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">      let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> url</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">url</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">?</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> toData</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">open</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">type</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> url</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> obj</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">async</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">send</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // 接收返回过来的数据</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">onreadystatechange</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> ()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">readyState</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 4</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">status</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &gt;=</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 200</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> &amp;&amp;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">status</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 300</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ||</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">status</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ==</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 304</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">          resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#BD976A;">JSON</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">parse</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">responseText</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">          reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">xhr</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">status</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  ajax</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">({</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">    url</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">./data/students.json?name=李华</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // success: function(data) {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // }</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // 速写</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    success</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><p>如果当前的Promise已经是resolved状态，该函数会立即执行</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">未决阶段</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">123</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //pro的状态是resloved</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 123</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>如果当前是未决阶段，则会加入到作业队列，等待到达resolved状态后执行</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">未决阶段</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">123</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //pro的状态是pending</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 可以注册多个then用来表示已决做什么</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>catchable</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">未决阶段</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">        if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.5</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">            resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">123</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">            reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;">new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">sanjs</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>封装初级演示1</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">god</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">向</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">\${</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">god</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">发出了请求</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">            if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">                resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 一定resolve成功</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">            }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">                //resolve</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">                resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//  一定resolve成功</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">            }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//一定成功，失败指的是短信发不出去</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>演示2</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // const pro = new Promise((resolve, reject) =&gt; {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //     console.log(&quot;未决阶段&quot;)</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //     resolve(123);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // })</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // pro.then(data =&gt; {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">     // pro的状态是resolved</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //     console.log(data);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    // })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">未决阶段</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">            resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">123</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">        // pro的状态是pending</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">        // pro的状态是pending</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">        // pro的状态是pending</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>演示4</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">未决阶段</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">            if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">random</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.5</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">                resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">123</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">            }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">                reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;">new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">asdfasdf</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">            }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>演示5</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">a</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">            console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">b</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    //pro: resolved</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">c</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>在未决阶段的处理函数中，如果发生未捕获的错误，会将状态推向rejected，并会被catchable捕获</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">        throw</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">123</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 导致pro变成rejected</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&lt;/</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">script</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>一旦状态推向了已决阶段，无法再对状态做任何更改。（未捕获的错误）</p><p>如果已经捕获了错误</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    try</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">        throw</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">abc</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //错误被捕获，有效了</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //无效</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //无效</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //无效</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>未决阶段的处理函数是同步的，会立即执行thenable和catchable函数是异步的，就算是立即执行，也会加入到事件队列中等待执行，并且，加入的队列是微队列</p><p>注意：thenable和catchable函数是异步的，就算是立即执行，也会加入到事件队列中等待执行，并且，加入的队列是<strong>微队列</strong></p><h2 id="promise的串联" tabindex="-1">Promise的串联 <a class="header-anchor" href="#promise的串联" aria-label="Permalink to &quot;Promise的串联&quot;">​</a></h2><p>当后续的Promise需要用到之前的Promise的处理结果时，需要Promise的串联 Promise对象中，无论是then方法还是catch方法，它们都具有返回值，返回的是一个全新的Promise对象，它的状态满足下面的规则：</p><ol><li>如果当前的Promise是未决的，得到的新的Promise是挂起状态</li><li>如果当前的Promise是已决的，会运行响应的后续处理函数，并将后续处理函数的结果（返回值）作为resolved状态数据，应用到新的Promise中；如果后续处理函数发生错误，则把返回值作为rejected状态数据，应用到新的Promise中。</li></ol><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> ajax</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">({</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">  url</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">./data/students.json</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 这里面要运行完pro2才已决</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  // throw new Error(&#39;错误&#39;)// reject</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">].</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">李华</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">      const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> cid</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">].</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">classId</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>面试题：<strong>后续的Promise一定会等到前面的Promise有了后续处理结果后，才会变成已决状态</strong></p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//fulfilled</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// pro2是一个Promise对象</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//pending</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 因为then是异步的，运行到打印pro2的时候函数还没调用(同步代码)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>面试题</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//这里变成状态数据:2，pro2变成了已决</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>面试题</strong></p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  throw</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 推向rejected,导致pro2的err运行</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 3, 此时pro2已决了</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//这里主要看上述处理有没有错误，pro2没有错误，执行result</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">结果</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">：</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">6</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>变式</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  throw</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  throw</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>思考：then函数返回的Promise对象一开始一定是挂起状态：因为then的后序处理是异步的</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  throw</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 这里是第一个调用then的，只看这里的处理函数</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//3</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro3</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 这里得到的是一个新的Promise</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  throw</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//1*2</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 输出6，调用的是result</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 输出6，调用的是err</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>如果前面的Promise的后续处理，返回的是一个Promise，则返回的新的Promise状态和后续处理返回的Promise状态保持一致。</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro3</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 2</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>变式</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro3</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">结果出来了，得到的是一个Promise</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//一开始Pro1已决了，所以这个一开始就执行</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// Pro3要跟pro2状态保持一致，pro2还没运行出来，pro3得等着</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 2；所以这里要等3s后才输出</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>简化为链式编程：便于阅读</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">结果出来了，得到的是一个Promise</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 这只是打印结果，对后续有影响的是函数的返回值</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  // 不写，默认return undefined</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// undefined</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>解决实战问题</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//获取李华所在班级的老师的信息</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//1. 获取李华的班级id   Promise</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//2. 根据班级id获取李华所在班级的老师id   Promise</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//3. 根据老师的id查询老师信息   Promise</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> ajax</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">({</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">  url</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">./data/students.json</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">].</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">name</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">李华</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">].</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">classId</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //班级id</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">cid</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> ajax</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">({</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">    url</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">./data/classes.json?cid=</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> cid</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">cls</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> cls</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">cls</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">].</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> cid</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> cls</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">].</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">teacherId</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">tid</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> ajax</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">({</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">    url</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">:</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">./data/teachers.json</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">ts</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> ts</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">ts</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">].</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">id</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> tid</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> ts</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">];</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">teacher</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">teacher</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>实战案例</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">god</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">向</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">\${</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">god</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">发出了请求</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 500</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神1同意了</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#BD93F9;--shiki-dark:#CB7676;"> undefined</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神2同意了</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神3</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#BD93F9;--shiki-dark:#CB7676;"> undefined</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神3同意了</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">都被拒绝了！</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 切记：上一个处理的结果就是下一个处理的状态数据</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>优化：增加了初始化</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> gods</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> [</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神3</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神4</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神5</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">];</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> gods</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">gods</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">]);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#BD93F9;--shiki-dark:#CB7676;"> undefined</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">\${</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">gods</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">]</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">同意了</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">\${</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">gods</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">]</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">拒绝了</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> gods</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#B8A965;">length</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">        return</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">gods</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">[</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">]);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="promise的其他api" tabindex="-1">Promise的其他API <a class="header-anchor" href="#promise的其他api" aria-label="Permalink to &quot;Promise的其他API&quot;">​</a></h2><h3 id="原型成员-实例成员" tabindex="-1">原型成员 (实例成员) <a class="header-anchor" href="#原型成员-实例成员" aria-label="Permalink to &quot;原型成员 (实例成员)&quot;">​</a></h3><ul><li>then：注册一个后续处理函数，当Promise为resolved状态时运行该函数</li><li>catch：注册一个后续处理函数，当Promise为rejected状态时运行该函数</li><li>finally：[ES2018]注册一个后续处理函数（无参），当Promise为已决时运行该函数</li></ul><blockquote><p>一个Promise不可能then，catch都执行</p></blockquote><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">finally</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">finally1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">finally</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">finally2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">then1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">then2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">catch1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">catch2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="构造函数成员-静态成员" tabindex="-1">构造函数成员 （静态成员） <a class="header-anchor" href="#构造函数成员-静态成员" aria-label="Permalink to &quot;构造函数成员 （静态成员）&quot;">​</a></h3><ul><li>resolve(数据)：该方法返回一个resolved状态的Promise，传递的数据作为状态数据</li></ul><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 等效于：</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>特殊情况：如果传递的数据是Promise，则直接返回传递的Promise对象</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> p</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// const pro = Promise.resolve(p);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//等效于</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> p</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ===</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> p</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//true</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>reject(数据)：该方法返回一个rejected状态的Promise，传递的数据作为状态数据</li></ul><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 等效于：</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>all(iterable)：这个方法返回一个新的promise对象，该promise对象在iterable参数对象里所有的promise对象<strong>都成功的时候才会触发成功</strong>，一旦有任何一个iterable里面的promise对象失败则立即触发该promise对象的失败。这个新的promise对象在触发成功状态以后，会把一个包含iterable里所有promise返回值的数组作为成功回调的返回值，顺序跟iterable的顺序保持一致；如果这个新的promise对象触发了失败状态，它会把iterable里第一个触发失败的promise对象的错误信息作为它的失败错误信息。Promise.all方法常被用于处理多个promise对象的状态集合。</li></ul><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> getRandom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">min</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> max</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">floor</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">max</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> min</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> min</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> proms</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> [];</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">push</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;">new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.5</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">完成</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">失败</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> getRandom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 5000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }))</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//等到所有的promise变成resolved状态后输出: 全部完成</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">all</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 把proms数组传进去，返回新的promise对象，必须等到所有promise都变成resolve后才变成resolve</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">datas</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">全部完成</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> datas</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">有失败的</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 为什么这里直接输出promise数组？因为这是同步代码，同步创建的Promise,只是promise状态需要等待</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><ul><li>race(iterable)：当iterable参数里的任意一个子promise被成功或失败后，父promise马上也会用子promise的成功返回值或失败详情作为参数调用父promise绑定的相应句柄，并返回该promise对象</li></ul><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> getRandom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">min</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> max</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">floor</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">max</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> min</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> min</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> proms</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> [];</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 10</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">push</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;">new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.5</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">完成</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">失败</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">i</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> getRandom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 5000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }))</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//等到所有的promise变成resolved状态后输出: 全部完成</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// const pro = Promise.all(proms)</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//  pro.then(data =&gt; {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//    console.log(&quot;全部完成了&quot;, data);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//  })</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//  pro.catch(err =&gt; {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//    console.log(&quot;有人失败了&quot;, err);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//  })</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">race</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">有人完成了</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">有人失败了</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>应用</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">god</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.05</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">god</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">同意</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">god</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">拒绝</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">floor</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> *</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3000</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> -</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">));</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> proms</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> [];</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> hasAgree</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 是否有女神同意</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">for</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">let</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;=</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 20</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">女神</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">\${</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">i</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resp</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">      if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">hasAgree</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">发错了短信，很机智的拒绝了</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        hasAgree</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">很开心，终于成功了！</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">      }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    }</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> resp</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">push</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">all</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">results</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">日志记录</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> results</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><ul><li>Promise.allSettled</li></ul><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">allSettled</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">([</span></span>
<span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">  Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">  Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">  Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">error</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">]).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  /* </span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  result: [</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    {status: &quot;fulfilled&quot;, value: 1},</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    {status: &quot;fulfilled&quot;, value: 2},</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">    {status: &quot;rejected&quot;, reason: &quot;error&quot;}</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  ]</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">	*/</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>新规范方法<code>Promise.allSettled</code>等待全部已决，不存在失败</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">allSettled</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">Promise.all resolved</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">reason</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">Promise.all rejected</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> reason</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>应用</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> proms</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> [</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// Promise数组</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">failed</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)),</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">failed</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)),</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">];</span></span>
<span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">allSettled</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> sum</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">reduce</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">a</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> b</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> +</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">b</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">value</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> ??</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 这个0表示第一次的值</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">                          console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">sum</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>Promise.any</li></ul><p>ES2021 将引入 Promise.any() 方法，一旦该方法从 promise 列表或数组中命中首个 resolve(成功) 的 promise ，就会短路并返回一个值。如果所有 promise 都被 reject ，该方法则将抛出一个聚合的错误信息 （在 Example 1b 里有所展示）。 其区别于 Promise.race() 之处在于，后者在某个 promise 率先 resolve 或 reject 后都会短路。 示例</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> proms</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> [</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">failed</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)),</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">),</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  getTestPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">false</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">failed</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)),</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">];</span></span>
<span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">any</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">proms</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">datas</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">Promise.all resolved</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> datas</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">reason</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">Promise.all rejected</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> reason</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>一个成功，就返回成功的那个data 全部失败，就会返回一个对象，对象里面有一个数组，记录错误</p><h2 id="async和await" tabindex="-1">async和await <a class="header-anchor" href="#async和await" aria-label="Permalink to &quot;async和await&quot;">​</a></h2><p>async 和 await 是 ES2016 新增两个关键字，它们借鉴了 ES2015 中生成器在实际开发中的应用，目的是简化 Promise api 的使用，并非是替代 Promise。</p><h3 id="async" tabindex="-1">async <a class="header-anchor" href="#async" aria-label="Permalink to &quot;async&quot;">​</a></h3><p>目的是简化在函数的返回值中对Promise的创建 async 用于修饰函数（无论是函数字面量还是函数表达式），放置在函数最开始的位置，被修饰函数的返回结果一定是 Promise 对象。 存在setTimeout就不能用了</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 完成时候的数据</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//等效于</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>如果里面返回Promise就会返回这个Promise对象</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="await" tabindex="-1">await <a class="header-anchor" href="#await" aria-label="Permalink to &quot;await&quot;">​</a></h3><p><strong>await关键字必须出现在async函数中！！！！</strong> await用在某个表达式之前，如果表达式是一个Promise，则得到的是thenable中的状态数据。</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">test2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>等效于</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">        console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">        test1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">().</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">            const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">            console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">            resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">        })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">test2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>如果await的表达式不是Promise，则会将其使用Promise.resolve包装后按照规则运行</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 等同于 await Promise.resolve(1)</span></span>
<span class="line"><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">  \`</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">await</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">也可以等待其他数据</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//等价于</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">    Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">      const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">123</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 先123 1 返回的是promise 不会阻塞</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>演示4</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> getPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  if</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.5</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> else</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    throw</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  try</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">    const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> getPromise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">正常状态</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">错误状态</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>改造计时器函数</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> delay</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">duration</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> duration</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> biaobai</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">god</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">向</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">\${</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#C98A7D;">god</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">}</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">发出了表白短信</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D77;">\`</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> delay</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">500</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> Math</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">random</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> &lt;</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0.3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="再谈异步" tabindex="-1">再谈异步 <a class="header-anchor" href="#再谈异步" aria-label="Permalink to &quot;再谈异步&quot;">​</a></h2><p>单线程的主要优势是不需要考虑线程调度，降低了程序的复杂性</p><p>但在单线程中如果要处理需要等待的任务时，就必须要考虑阻塞的问题。</p><p>考虑下面的伪代码：</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> dom</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">name</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 获取某个dom元素</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> syncConnect</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">http://server/getname</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 以同步的方式向服务器获取名字</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">dom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">innerHTML</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> name</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">otherTask</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 其他无关任务</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="`+e+`" alt=""></p><p>因此，JS引入异步来处理该问题</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> dom</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> document</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">getElementById</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">name</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 获取某个dom元素</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">asyncConnect</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">http://server/getname</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> callback</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">){</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //以异步的方式向服务器获取名字</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  dom</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">innerHTML</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> result</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">otherTask</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 其他无关任务</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="`+F+`" alt=""></p><h3 id="执行栈" tabindex="-1">执行栈 <a class="header-anchor" href="#执行栈" aria-label="Permalink to &quot;执行栈&quot;">​</a></h3><p>要想执行必须有执行上下文 JS执行引擎只会执行栈顶端的东西</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> A</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">A</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 函数调用，新建log上下文，入栈，执行完出栈</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  B</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 建立B的上下文</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> B</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">B</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// log上下文</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">A</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 创建A的上下文，入栈。JS执行引擎只会执行栈顶端的东西，所以不执行下一句，而是执行A</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">global</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 答案：A B global</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="演练场" tabindex="-1">演练场 <a class="header-anchor" href="#演练场" aria-label="Permalink to &quot;演练场&quot;">​</a></h2><h3 id="怎样理解js的异步" tabindex="-1">怎样理解JS的异步？ <a class="header-anchor" href="#怎样理解js的异步" aria-label="Permalink to &quot;怎样理解JS的异步？&quot;">​</a></h3><p>答案：事件发生、等待网络通信完成、等待计时结束等等。如果在执行线程上去等待，就浪费线程的宝贵执行时间，<strong>阻塞后续操作</strong>。更可怕的是，由于浏览器<strong>GUI线程和JS执行线程是互斥的</strong>，这就导致浏览器界面会因为JS的等待处于卡死状态。因此，JS通过异步来解决这个问题，当需要等待的时候，通知宿主的其他线程去做处理，执行线程则继续后续执行。当其他线程完成处理后，会发出通知，此时执行线程转而去执行事先定义好的回调函数即可。异步的方式充分了解放了执行线程，让执行线程可以毫无阻塞的运行，也就避免了浏览器宿主因为等待操作完成出现的卡死现象。</p><p>考点：GUI线程怎么渲染的？ JS社区提出了<code>Promise A+</code>规范，希望把异步规范化，并消除回调地狱 再后来，ES6 官方标准中提出了 <code>Promise API</code> 来处理异步，它满足 <code>Promise A+</code> 规范 由于异步处理变得标准了，就给ES官方提供了进一步改进的空间，于是在ES7中出现了新的语法<code>async await</code>，它更加完美的解决了异步处理问题</p><p><img src="`+r+`" alt=""></p><h3 id="高仿settimeout" tabindex="-1">高仿setTimeout <a class="header-anchor" href="#高仿settimeout" aria-label="Permalink to &quot;高仿setTimeout&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> delay</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">duration</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> duration</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  });</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> delay</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> delay</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="高仿setinterval" tabindex="-1">高仿setInterval <a class="header-anchor" href="#高仿setinterval" aria-label="Permalink to &quot;高仿setInterval&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> delay</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">duration</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    },</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> duration</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  });</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> count</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  while</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> delay</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">count</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">++</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  }</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">test</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="如何理解js的单线程" tabindex="-1">如何理解JS的单线程? <a class="header-anchor" href="#如何理解js的单线程" aria-label="Permalink to &quot;如何理解JS的单线程?&quot;">​</a></h3><p>我们之所以称JS为单线程的语言，是因为它的执行引擎只有一个线程，并且不会在执行期间开启新的线程。而并非浏览器是单线程的。</p><p>单线程的应用程序具有以下的特点：</p><ul><li>易于学习和理解：所有代码都是按照顺序从上到下执行的</li><li>易于掌控程序：由于代码都按照顺序执行，不会出现中断，也没有共享资源的争夺问题，极大的降低了开发难度。</li><li>更加合理的利用计算机资源：创建新的线程和销毁线程都会耗费额外的CPU和内存资源，没有良好的线程设计，将导致程序运行效率低下。而单线程的应用不受此影响</li></ul><h3 id="说一下-js-异步解决方案发展历程" tabindex="-1">说一下 JS 异步解决方案发展历程 <a class="header-anchor" href="#说一下-js-异步解决方案发展历程" aria-label="Permalink to &quot;说一下 JS 异步解决方案发展历程&quot;">​</a></h3><ul><li>回调函数(callback)</li></ul><p>优点:解决了同步的问题(只要有一个任务耗时很长,后面的任务都必须排队,等着,会拖延整个程序的执行。)</p><p>缺点:回调地狱,不能用try catch捕获错误,不能return</p><ul><li>Promise</li></ul><p>优点:解决了回调地狱的问题</p><p>缺点:无法取消Promise,错误需要通过回调函数来捕获</p><ul><li>Generator</li></ul><p>特点:可以控制函数的执行,可以配合co函数库使用</p><ul><li>Async/await</li></ul><p>优点:代码清晰,不用像Promise写一大堆then链,处理了回调地狱的问题</p><p><strong>async较Generator的优势：</strong></p><p>✅ 内置执行器。Generator函数的执行必须依靠执行器，而 Aysnc 函数自带执行器，调用方式跟普通函数的调用一样</p><p>✅ 更好的语义。async和await相较于*和yield 更加语义化</p><p>✅ 更广的适用性。yield命令后面只能是Thunk函数或Promise对象，async函数的await后面可以是Promise也可以是原始类型的值</p><p>✅ 返回值是Promise。async函数返回的是Promise对象，比Generator函数返回的Iterator对象方便，可以直接使用then()方法进行调用</p><p>缺点: await将异步代码改造成同步代码,如果多个异步操作没有依赖性而使用await会导致性能上的降低。有传染性</p><h3 id="promise缺点" tabindex="-1">Promise缺点 <a class="header-anchor" href="#promise缺点" aria-label="Permalink to &quot;Promise缺点&quot;">​</a></h3><p>答案：无法取消</p><blockquote><p>axios请求也是Promise,怎么取消请求的cancalToken</p></blockquote><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // 有await和没有有啥不一样：await要等待状态。一定使得a=?异步执行</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">999</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// promise的await使代码具有传染性，不管await是什么，都会变成异步，好不好？</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 关于API设计，想时异步时同步（stateState)还是永远异步（await）还是node的可以同步可以异步？</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="await后面接什么" tabindex="-1"><strong>await后面接什么？</strong> <a class="header-anchor" href="#await后面接什么" aria-label="Permalink to &quot;**await后面接什么？**&quot;">​</a></h3><p>答案：Promise对象 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/await" target="_blank" rel="noreferrer">await</a></p><h3 id="catch-能不能模拟then效果" tabindex="-1">catch，能不能模拟then效果 <a class="header-anchor" href="#catch-能不能模拟then效果" aria-label="Permalink to &quot;catch，能不能模拟then效果&quot;">​</a></h3><h3 id="代码输出结果" tabindex="-1">代码输出结果 <a class="header-anchor" href="#代码输出结果" aria-label="Permalink to &quot;代码输出结果&quot;">​</a></h3><p>下面的代码输出结果是 ：</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> pro</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">5</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">6</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">pro</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">data</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">data</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> err</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">7</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">// 24731</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>下面的代码输出结果是 ：</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">	setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//等着1</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  throw</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">error</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>变式</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//2取决于1的话，看处理没处理这个状态，处理了，看他处理过程，没有处理就漏下来</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  throw</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">error</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//此处成功了没有处理，状态和1一样。这里只处理了错误</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //fulfilled</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>变式</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//promise是rejected</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//处理了错误，处理的过程没报错</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">	return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">	//此处要执行</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // rejected</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // fulfiled</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>变式</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">  // 这里要是报错，发生在同步代码里面，返回rejected。</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    throw</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//但是此处跑错是在异步代码里面。执行的此处的时候，已经没有proimise环境了</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">	return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // pending</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> // pending</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>下面代码的运行结果是</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">success1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">error</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">success2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">promise</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">then: </span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">catch: </span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>下面的代码输出结果是多少</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//返回一个新Promsie,状态为成功</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;"> //2</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>下面的代码输出结果是多少</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    return</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> Error</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">error!!!</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//这里是return 不是throw。没报错，只是返回了一个错误对象</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">then: </span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> res</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">catch: </span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> err</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  })</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>下面的代码输出结果是多少</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">	// promise  fullfilled   1</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//如果then里传递的不是函数，就当没执行就行</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//传递的是对象，then必须传函数，也是无效</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#6272A4;--shiki-dark:#758575DD;">//函数  console.log(1)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">      console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">      resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    	console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">    })</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">5</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">	setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">catch</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> promise2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;"> </span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">n</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">m</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">n</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> ()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">})();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;"> await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">n</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(){</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">  const</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> n</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> m2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">n</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  return</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">m3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">().</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">n</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">n</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">m3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">4</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#DBD7CACC;">	</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;">Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;">3</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">))</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  .</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> a</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">var</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> b</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">((</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;">=&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">{</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">  },</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 1000</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise3</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(()</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise4</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =</span><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;"> new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> (</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">,</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;"> reject</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#FF79C6;--shiki-dark:#444444;"> =&gt;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  await</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> b</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">;</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">a</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">after1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">  await</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;"> a</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">  resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">  console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">after2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">end</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>下面代码的输出结果是什么</p><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes dracula vitesse-black vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> async1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">async1 start</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#4D9375;">    await</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> async2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">async1 end</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">async</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;"> function</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;"> async2</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">	console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">async2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">script start</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">setTimeout</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">setTimeout</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">},</span><span style="--shiki-light:#BD93F9;--shiki-dark:#4C9A91;"> 0</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">async1</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#FF79C6;--shiki-light-font-weight:bold;--shiki-dark:#CB7676;--shiki-dark-font-weight:inherit;">new</span><span style="--shiki-light:#8BE9FD;--shiki-light-font-style:italic;--shiki-dark:#B8A965;--shiki-dark-font-style:inherit;"> Promise</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FFB86C;--shiki-light-font-style:italic;--shiki-dark:#BD976A;--shiki-dark-font-style:inherit;">resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">)</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise1</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">    resolve</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">();</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">}).</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">then</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#FF79C6;--shiki-dark:#CB7676;">function</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">()</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;"> {</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">    console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">promise2</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">});</span></span>
<span class="line"><span style="--shiki-light:#F8F8F2;--shiki-dark:#BD976A;">console</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">.</span><span style="--shiki-light:#50FA7B;--shiki-dark:#80A665;">log</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">(</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F1FA8C;--shiki-dark:#C98A7D;">script end</span><span style="--shiki-light:#E9F284;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#F8F8F2;--shiki-dark:#444444;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div>`,241)]))}const u=i(d,[["render",g]]);export{D as __pageData,u as default};
